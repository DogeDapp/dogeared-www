(function(){function o(a){d[a]=function(){var b=arguments;return d.ready().then(function(){return d[a].apply(d,b)})}}var k=typeof module!=="undefined"&&module.exports?require("promise"):this.Promise,f={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"},p=[f.INDEXEDDB,f.WEBSQL,f.LOCALSTORAGE],n=["clear","getItem","key","keys","length","removeItem","setItem"],h={DEFINE:1,EXPORT:2,WINDOW:3},i=h.WINDOW;if(typeof define==="function"&&define.amd)i=h.DEFINE;else if(typeof module!==
"undefined"&&module.exports)i=h.EXPORT;for(var q=function(a){var b=b||a.indexedDB||a.webkitIndexedDB||a.mozIndexedDB||a.OIndexedDB||a.msIndexedDB,e={};e[f.WEBSQL]=!!a.openDatabase;e[f.INDEXEDDB]=!!(b&&typeof b.open==="function"&&b.open("_localforage_spec_test",1).onupgradeneeded===null);a=f.LOCALSTORAGE;var c;try{c=localStorage&&typeof localStorage.setItem==="function"}catch(l){c=false}e[a]=!!c;return e}(this),r=this,d={INDEXEDDB:f.INDEXEDDB,LOCALSTORAGE:f.LOCALSTORAGE,WEBSQL:f.WEBSQL,_config:{description:"",
name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},_driverSet:null,_ready:false,config:function(a){if(typeof a==="object"){if(this._ready)return Error("Can't call config() after localforage has been used.");for(var b in a)this._config[b]=a[b];return true}else return typeof a==="string"?this._config[a]:this._config},driver:function(){return this._driver||null},ready:function(a){var b=new k(function(e,c){d._driverSet.then(function(){if(d._ready===null)d._ready=d._initStorage(d._config);
d._ready.then(e,c)},c)});b.then(a,a);return b},setDriver:function(a,b,e){var c=this;if(typeof a==="string")a=[a];return this._driverSet=new k(function(l,s){var g=c._getFirstSupportedDriver(a);if(g){c._ready=null;if(i===h.DEFINE)require([g],function(t){c._extend(t);b&&b();l()});else{if(i===h.EXPORT){var j;switch(g){case c.INDEXEDDB:j=require("./drivers/indexeddb");break;case c.LOCALSTORAGE:j=require("./drivers/localstorage");break;case c.WEBSQL:j=require("./drivers/websql")}c._extend(j)}else c._extend(r[g]);
b&&b();l()}}else{g=Error("No available storage method found.");c._driverSet=k.reject(g);e&&e(g);s(g)}})},supports:function(a){return!!q[a]},_extend:function(a){for(var b in a)if(a.hasOwnProperty(b))this[b]=a[b]},_getFirstSupportedDriver:function(a){var b=Array.isArray||function(c){return Object.prototype.toString.call(c)==="[object Array]"};if(a&&b(a))for(b=0;b<a.length;b++){var e=a[b];if(this.supports(e))return e}return null}},m=0;m<n.length;m++)o(n[m]);d.setDriver(p);if(i===h.DEFINE)define(function(){return d});
else if(i===h.EXPORT)module.exports=d;else this.localforage=d}).call(this);
